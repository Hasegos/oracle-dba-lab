-- ----------------------------------------------------------------------
-- 🎯 문제 정보
-- ----------------------------------------------------------------------
-- 프로그래머스 SQL (Level 1)
-- 문제 : 조건에 맞는 도서 리스트 출력하기
-- 핵심 내용 : 1. 발행년도(PUBLISHED_DATE)가 2021년인 도서만 조회
--            2. 카테고리가 '인문'인 도서로 제한
-- 해결방안 : BOOK 테이블에서 조건에 맞는 도서를 필터링하고
--            발행일을 'YYYY-MM-DD' 형식으로 변환한 뒤 오름차순 정렬하여 출력
-- ----------------------------------------------------------------------

-- ----------------------------------------------------------------------
-- 1. 테이블 및 컬럼 정의 (CREATE TABLE)
-- ----------------------------------------------------------------------
CREATE TABLE BOOK (
    BOOK_ID	INTEGER	NOT NULL,
    CATEGORY VARCHAR(50)	NOT NULL,	
    AUTHOR_ID	INTEGER		NOT NULL,	
    PRICE	INTEGER		NOT NULL,
    PUBLISHED_DATE	DATE	NOT NULL	
);

-- 📌 아래 CREATE/INSERT 구문은 프로그래머스 문제에서 제공된 원본 데이터 형식을 그대로 사용
-- ----------------------------------------------------------------------
-- 2. 테스트 데이터 삽입 (INSERT)
-- ----------------------------------------------------------------------
INSERT INTO BOOK VALUES (1, '인문', 1, 10000, '2020-01-01');
INSERT INTO BOOK VALUES (2, '경제', 2, 9000, '2021-02-05');
INSERT INTO BOOK VALUES (3, '인문', 2, 11000, '2021-04-11');
INSERT INTO BOOK VALUES (4, '인문', 3, 10000, '2021-03-15');
INSERT INTO BOOK VALUES (5, '생활', 1, 12000, '2021-01-10');

-- 테스트 데이터 확인
SELECT * FROM BOOK;

-- ----------------------------------------------------------------------
-- 3. [답안] 문제 해결 SQL (SELECT)
-- ----------------------------------------------------------------------
SELECT
    BOOK_ID,
    TO_CHAR(PUBLISHED_DATE, 'YYYY-MM-DD') AS PUBLISHED_DATE
    FROM BOOK 
    WHERE TO_CHAR(PUBLISHED_DATE, 'YYYY') = '2021'
    AND CATEGORY = '인문'
    ORDER BY PUBLISHED_DATE ASC;
            
-- ----------------------------------------------------------------------
-- 4. 사용 후 처리 (DROP TABLE)
-- ----------------------------------------------------------------------
DROP TABLE BOOK;