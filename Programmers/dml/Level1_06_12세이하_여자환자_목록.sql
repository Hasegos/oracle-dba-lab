-- ----------------------------------------------------------------------
-- 🎯 문제 정보
-- ----------------------------------------------------------------------
-- 프로그래머스 SQL (Level 1)
-- 문제 : 어린 여자 환자 목록 출력하기
-- 핵심 내용 : 1. 나이가 12세 이하이고 성별 코드가 여성(GEND_CD = 'W')인 환자 조회
--            2. 전화번호가 없는 경우 'NONE'으로 출력
-- 해결방안 : PATIENT 테이블에서 AGE와 GEND_CD 조건으로 필터링하고
--            NVL 함수를 이용해 전화번호 NULL 처리 후 AGE 내림차순, 이름 오름차순 정렬
-- ----------------------------------------------------------------------

-- ----------------------------------------------------------------------
-- 1. 테이블 및 컬럼 정의 (CREATE TABLE)
-- ----------------------------------------------------------------------
CREATE TABLE PATIENT (
    PT_NO	VARCHAR(10)	NOT NULL,
    PT_NAME	VARCHAR(20)	NOT NULL,
    GEND_CD	VARCHAR(1)	NOT NULL,
    AGE	INTEGER	NOT NULL,
    TLNO	VARCHAR(50)	
);

-- 📌 아래 CREATE/INSERT 구문은 프로그래머스 문제에서 제공된 원본 데이터 형식을 그대로 사용
-- ----------------------------------------------------------------------
-- 2. 테스트 데이터 삽입 (INSERT)
-- ----------------------------------------------------------------------
INSERT INTO PATIENT VALUES ('PT22000003', '브라운', 'M', 18, '01031246641');
INSERT INTO PATIENT VALUES ('PT22000004', '크롱', 'M', 7, null);
INSERT INTO PATIENT VALUES ('PT22000006', '뽀뽀', 'W', 8, null);
INSERT INTO PATIENT VALUES ('PT22000009', '한나', 'W', 12, '01032323117');
INSERT INTO PATIENT VALUES ('PT22000012', '뿡뿡이', 'M', 5, null);
INSERT INTO PATIENT VALUES ('PT22000013', '크리스', 'M', 30, '01059341192');
INSERT INTO PATIENT VALUES ('PT22000014', '토프', 'W', 22, '01039458213');
INSERT INTO PATIENT VALUES ('PT22000018', '안나', 'W', 11, null);
INSERT INTO PATIENT VALUES ('PT22000019', '바라', 'W', 10, '01079068799');
INSERT INTO PATIENT VALUES ('PT22000021', '릴로', 'W', 33, '01023290767');

-- 테스트 데이터 확인
SELECT * FROM PATIENT;

-- ----------------------------------------------------------------------
-- 3. [답안] 문제 해결 SQL (SELECT)
-- ----------------------------------------------------------------------
SELECT
    PT_NAME,
    PT_NO,
    GEND_CD,
    AGE,
    NVL(TLNO,'NONE') as TLNO
    FROM PATIENT 
    WHERE AGE <= 12 AND GEND_CD = 'W'
    ORDER BY AGE DESC,
            PT_NAME ASC;
            
-- ----------------------------------------------------------------------
-- 4. 사용 후 처리 (DROP TABLE)
-- ----------------------------------------------------------------------
DROP TABLE PATIENT;